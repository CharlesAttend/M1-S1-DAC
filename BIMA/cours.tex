\documentclass{article}
\usepackage[utf8]{inputenc}
\usepackage[a4paper, margin=2.5cm]{geometry}
\usepackage{graphicx}
\usepackage[french]{babel}

\usepackage[default,scale=0.95]{opensans}
\usepackage[T1]{fontenc}
\usepackage{amssymb} %math
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{systeme}

\usepackage{hyperref}
\hypersetup{
    colorlinks=true,
    linkcolor=blue,
    filecolor=magenta,      
    urlcolor=cyan,
    pdftitle={BIMA},
    % pdfpagemode=FullScreen,
    }
\urlstyle{same} %\href{url}{Text}

\theoremstyle{plain}% default
\newtheorem{thm}{Théorème}[section]
\newtheorem{lem}[thm]{Lemme}
\newtheorem{prop}[thm]{Proposition}
\newtheorem*{cor}{Corollaire}
%\newtheorem*{KL}{Klein’s Lemma}

\theoremstyle{definition}
\newtheorem{defn}{Définition}[section]
\newtheorem{exmp}{Exemple}[section]
% \newtheorem{xca}[exmp]{Exercise}

\theoremstyle{remark}
\newtheorem*{rem}{Remarque}
\newtheorem*{note}{Note}
%\newtheorem{case}{Case}



\title{Base du traitement d'image}
\author{Charles Vin}
\date{S1-2022}

\begin{document}
\maketitle

\underline{Nouveau cours du 13/09} \\

https://www-master.ufr-info-p6.jussieu.fr/parcours/ima/bima/

TP : correction avec échantillonnage random
Une semaine pour les faire, il veut qu'on aille plus loins que les question ? 
40\% CC et 50\% Exam, pas de DS1 

Prise en compte de la perception dans le traitement d'image (sinon on ferait du traitement de signal) : exemple des illusions d'optiques

\subsection{Encodage d'image}
\subsubsection{RBG}
RGB = un cube \\
Limite de RGB :
\begin{itemize}
    \item Les 3 canaux sont très corrélé $\rightarrow$ Information redondante 
    \item Problème pour utiliser des distances euclidienne : certaine couleurs sont proche en distance mais sont pas du tout pareil
\end{itemize}
Extension : \begin{itemize}
    \item D'autre représentation : ACP 
    \item Utiliser des model plus proche de l'humais : HSV 
\end{itemize}

\subsubsection{HSV}
HSV = un cone 
\begin{itemize}
    \item Value : Moyenne de RGB 
    \item Hue : De la trigo comme c'est un cercle 
    \item Saturation : De la trigo comme c'est un cercle 
\end{itemize}

Brightness : juste la moyenne des valeur de l'image \\
Contrast : C'est lié à la distance entre le min et le max qu'on définie pour le niveau de gris. On regarde la distance entre les valeur min et max, on peut utiliser l'écart type. 

3 niveaux d'analyse/de compréhension des images:
\begin{itemize}
    \item Low : image => image \begin{itemize}
        \item Compression 
        \item Restauration (retirer le bruit)
        \item Filtrage (trouver uniquement les contours)
        \item Segmentation (un pixel = un label)
    \end{itemize}
    \item Mid : image => Attributes 
    \item High : image => understanding (semantic description)
\end{itemize}
Proche du processing fait par les réseaux de neurone

\underline{Nouveau cours du 20/09} \\

\section{Basic image transformations}
VOIR LE DIAPO AVANT 
\begin{itemize}
    \item Transformation affine
    \item Translation
    \item Change of scale
    \item Rotation
    \item Linear transformation
\end{itemize}

Cordonnée homogène : \begin{itemize}
    \item On ajoute une nouvelle coordonne qui vaut 1 partout. Ainsi maintenant une translation dans $ \mathbb{R}^2 $ peuvent s'exprimer comme une opération linéaire dans $ \mathbb{R}^3 $ 
    \item Ca permet d'être rapide comme les multiplications de matrice sont cablés dans les GPUs. 
    \item Problème : En pivotant une image on créé des trous dans l'image (un losange dans un carré) et les pixels ne sont plus carrés. Deux solutions : \begin{itemize}
        \item Direct transformation: pixels coordinates in the output image are determined from pixels coordinates in the input image \\
        $\rightarrow$ can generate missing data or superposition.
        \item Inverse transformation: pixels coordinates in the input image are determined from pixels coordinates in the output image \\
        $\rightarrow$ can generate superposition and also missing data (due to bounded spatial domain).
        \item IMAGE DIAPO 12
        \item Exemple DIAPO 13
    \end{itemize}
\end{itemize}

Méthode d'interpolation: 
Two examples of basic interpolation methods
\begin{itemize}
    \item Nearest neighbor: pixel value is given by the value of the nearest neighboring pixel
    \item Bilinear interpolation: pixel value is determined from the 4 nearest neighboring pixels using a bilinear interpolation (inconvéniant : lisse l'image, la rend flou)
\end{itemize}
Many other interpolation methods: B-splines, Hermite interpolation polynomials, ...
IMAGE DIAPO 14
\begin{note}[]
    Globalement deux opération en traitement d'image : Soit on moyenne, soit on intègre. On verra dans le TD3.
\end{note}

Application des transformations géométrique : 
\begin{itemize}
    \item Suivre les objets sur deux caméras différente (un passant qui passe d'une caméra à l'autre) Belle image dans le diapo 17. Tout peut se passer avec une matrice $ 3 \times 3 $.
    \item Faire le lien entre une carte dessiné et une image satellite. On peut détecter les points d’intérêt, ou en connaissant précisément la longitude et la latitude de chaque pixel
    \item Application médical : Superposition de plusieurs modalité provenant de plusieurs capteur. Même reconstruire en 3D.
    \item Compression vidéo : principe on essaye de prédire l'image suivant à partir de la précédente avec une fonction. Bref on regarde uniquement les pixel qui se déplace. 
\end{itemize}

\subsection{Operation between images}
Application : \begin{itemize}
    \item Soustration et réduction de bruit : Soit deux images $ I, I^n, I - I^n $ permet de détecter le bruit. On obtient alors que des pixels noir lorsqu'il n'y a pas de différence. Le reste est du bruit. \\
    $\rightarrow$ Permet également de trouver les changements dans le temps, détection de mouvement. (image diapo 31-32)
\end{itemize}

\subsection{Image thresholding}
\begin{itemize}
    \item Thresholding: reduction of image values to few levels of intensity
    \item Binarization: image values are reduced to two intensity levels
    \item Binary thresholding, defined by: 
    \[
        k' = \begin{cases}
        k_1 &\text{ si } k \leq S\\
        k_2 &\text{ si } k \geq S\\
        \end{cases} 
    .\]
    with $ k_1, k_2 $  and $ S $ (threshold) are levels of intensity
\end{itemize}
$\rightarrow$ Highlights regions but does not enhance the image

\subsection{Image enhancement}
\begin{defn}[]
    \begin{itemize}
        \item 
    \end{itemize}
\end{defn}
Trois catégories : \begin{itemize}
    \item Pixel level enhancement : \begin{itemize}
        \item the image brightness or contrast is modified
        \item no spatial information, only radiometric value of the visited pixel is considered
    \end{itemize}
    \item Local enhancement : Prend en compte le voisinage
    \item Enhancement in the frequency domain : on prend l'image, on quitte la représentation spacial et on bascule dans le domaine fréquentiel pour faire des changements avant de revenir dans domaine spacial.
\end{itemize}

Application : \begin{itemize}
    \item Regions to highlight
    \item Images that are too bright or too dark
    \item Intensity levels should be changed in order to make some details in the image more visible
    \item Modify image brightness
    \item Increase contrast (see Lecture 1)
    \item Pixel-level enhancement is closely related to histogram
    transformation
    \item IMAGE COOL DIAPO 41
\end{itemize}

\subsection{Histogram}
\begin{defn}[Histogram]
    Histogram is an array / function describing the image values (intensities / gray values / colors) distribution. 
    Provides image-specific information, such as:
    \begin{itemize}
        \item The statistical distribution of image values
        \item Minimal and maximal image values, moyenne, médiane
        \item \textbf{No spatial information at all (exemple diapo 44)}
    \end{itemize}
    Formule : 
    \[
        H(k) = \text{ complexe pour rien}
    .\]
    En réalité on parcours l'image et on regarde à quel interval il appartient et on incrémente celui-ci.
    
    \begin{exmp}[]
        Voir l'image diapo 43.
    \end{exmp}
\end{defn}
\begin{defn}[Normalized Histogram]
    Permet d'approximer la densité de la loi. Car l'histograme normale n'est pas conforme à la définition d'une densité (intégrale égal à 1). 

    Function Hn representing the probability (occurrence frequenc here) for a pixel to have a given value k 
    \[
        H_n(k) = \frac{H(k)}{N \times M}
    .\]
    with N and M are the image dimensions. Maintenant elle est à valeur dans $ \in  [0,1] $ 
\end{defn}
\begin{defn}[Cumulative Histogram]
    Permet d'avoir une estiamtion de la fonction de répartition. On fait la somme cumulative 
    \[
        H_C(k) = \sum_{i \leq k}^{H(i)}
    .\]
\end{defn}

\subsection{Image négative}
\begin{defn}[]
    negative of the image obtained by the negative transformation in the range of $[0, L - 1]$:
    \[
        k' = L - 1 -k
    .\]
    with $ l $  the dynamic range of the image (number of intensity levels)
\end{defn}

\subsection{Transformation}
\subsubsection{Logarithmic transformation}
\begin{defn}[]
    Low values increase, high values decrease: allows increasing
    the contrast in dark parts of the image.    
    \[
        k' = \log_{} (k)
    .\]
    Améliore le contraste dans les parties les plus sombre de l'image. EXEMPLE DIAPO 51
\end{defn}

\subsubsection{Exponential transformation}
\begin{defn}[]
    Low values decrease, high values increase: allows increasing the contrast in bright parts of the image. 
    \[
        k' = e^k
    .\]
\end{defn}

\subsection{Opération sur les histograme }
\begin{defn}[Histogram Translation]
    Changes the \textbf{brightness} of an image, leaving the contrast unchanged. The new image is brighter or darker. Useful for images having a low dynamic range.
    \[
        k' = k+t
    .\]
\end{defn}

\begin{defn}[Affine transformation]
    
\end{defn}

\begin{defn}[Image Normalization]
    On ramène les valeurs entre 0 et $ L-1 $.
    \begin{itemize}
        \item Let kmin and kmax be the minimal and maximal intensity levels
        of an image, respectively:
        \item Transformation: 
        \[
            k' = \frac{L - 1}{k_{max} - k_{min}} (k - k_{min})
        .\]
        \item After transformation, $ k' \in [0, L-1] $, contrast is maximal
        \item No loss of information (same number of intensity levels)
        \item Before visualization, an image is often normalized (but not necessarily)
    \end{itemize}
    SUPER EXEMPLE DANS LE DIAPO 59  
\end{defn}

\begin{defn}[Linear transformation with saturation]
    Cette fois ci on vas étirer l'histogramme uniquement dans un intervale donnée. Voir diapo 60 pour plus d'information.

    Cette fois il y a de la perte d'information.
\end{defn}

\begin{defn}[Histogram equalization]
    On vas le coder ahah. On prend l'histogramme et on le rend plat (équidistribué).\\ 
    \textbf{Perte d'information} mais bien pour la visualisation.
    \begin{itemize}
        \item Each intensity level is represented in the same proportion
        \item Regions of lower local contrast gain a higher contrast
        \item Global contrast increases
    \end{itemize}
    L'idée de la méthode : On fusions les pixels peu représenté avec les plus représenter.
    \[
        k' = Int(\frac{L-1}{N*M}H_c(k))
    .\]
    Avec \begin{itemize}
        \item $ L $ the image dynamic range
        \item $ N $ and $ M $  the image size
        \item $ H_c(k) $ the cumulative histogram
        \item $ Int $ rounding to the nearest integer
    \end{itemize}
    Super exemple dans le diapo 64. 
\end{defn}

\begin{note}[Histogram stretching versus histogram equalization: same operation?]
    \begin{itemize}
        \item Stretching: changes the bins distribution in the histogram, but not their size
        \item Equalization: changes the bins distribution in the histogram and their size
    \end{itemize}
\end{note}

\begin{note}[Application]
    \begin{itemize}
        \item Image mosaic : a target image and a base of small image.
        \item Face recognition : On suppose que les histogram d'image faciale ont la même loi de proba.
        \item Segmentation : En fusionnant beaucoup beaucoup les classes on peut segmenter en 5 couleurs (exemple diapo 70). Ou on utilise des algo de clustering
    \end{itemize}
\end{note}

\underline{Nouveau cours du 27/09} \\
15 min de retard, before diapo 11. 

En gros la transformé de Fourier permet de représenter les fonctions périodique avec des coordonnes dans l'espaces infinis des fonctions périodiques. Pourquoi \begin{itemize}
    \item Pour écrire les signaux de manière plus compact
    \item Pour pouvoir les compresser
    \item Pour pouvoir les comparer ensuite. 
    \item CCL : DIAPO 14 
\end{itemize}

Transformé de Fourier : La seule différence c'est qu'on obtient un continuum de fréquence 

\paragraph*{Interprétation du signal} : On obtient une représentation de notre fréquence en terme de fréquence (haute ou basse)\begin{itemize}
    \item On utilise le module $ \left| X(f) \right|  $ pour obtenir la quantité de la fréquence pure $ f $ présente dans le signal $ x $.
    \item La phase : L'angle de $ X(f) $ vue dans ce cas comme un vecteur du plans complexe
\end{itemize}
Le signal $ x $ peut être reconstruit à partir de sa transformé de Fourier $ X $. 

\begin{defn}[Convolution]
    Une sorte de moyenne locale de $ g $ pondéré par les valeur de $ f $. Opération commutative, distributive, associative.
\end{defn}

\paragraph*{Retour fourier diapo 26} 
Liste des propriétés :\begin{itemize}
    \item Linéaire
    \item Time scaling : Quand on multiplie un signal par un scalaire, on le stretch et il s'étend. A l'inverse sa transformé de Fourier se rétrécis 
    \item Time shifting : Si on translate le temps, on ne change pas la transformé
    \item Frequency shifting : translater les fréquence, translate la transformé de Fourier
    \item Théorème de la convolution : \begin{itemize}
        \item  Convolution assez complexe à calculer $ O(n^2) $ 
        \item Avec Fourier la convolution est super plus simple à calculer $ O(n \log_{}n) $ 
        \item Voir formule dans le diapo 26 si nécessaire
    \end{itemize}
\end{itemize}
\begin{exmp}[]
    Exemple d'une transformé de Fourier avec une fonction porte.
\end{exmp}
\begin{exmp}[]
    Exemple d'une transformé de Fourier avec une Gaussienne $\rightarrow$ On retrouve une gaussienne ! Damn c'est fou
\end{exmp}
\begin{exmp}[]
    Exemple d'une transformé de Fourier avec une fonction de Dirac $ \delta (t) $. C'est l'élément neutre de la convolution. Au final, on pondère la moyenne mobile sur un unique point $\rightarrow$ ca donne la valeur de la fonction en ce point. 
\end{exmp}
\begin{exmp}[]
    Exemple d'une transformé de Fourier de $ \sin  $ et $ \cos  $. C'est relativement facile en utilisant la formule d'Euler, qui donne deux exponentiel complexe, et une exponentielle complexe c'est une fonction de Dirac avec Fourier.
\end{exmp}

\paragraph*{Fourier en 2D}
Globalement la même chose sauf qu'on intègre pour chaque dimension. On obtient en couple de fréquence, et pour le plot on utilise l'intensité lumineuse pour représenter l'amplitude.

\textbf{Inportant:}la transformé de Fourier donne des information sur l'orientation des objects, leur taille, ect EXEMPLE DIAPO 53

DIAPO 54, quelque fonction très utile. Et diapo 55 illustration de ce que fait la fonction $ fftshift() $

Diapo 56 : On passe au log pour améliorer la visualisation. 

Quelques Applications : \begin{itemize}
    \item Débruiter : en supprimant les hautes fréquences
    \item Compression : Les petits détails sont haute fréquences donc on peut les supprimer.
    \item Obtenir les directions des choses ect
    \item Filtrer : edge detection, point d'intérêt, ... 
\end{itemize}

Désavantage d'une représentation fréquentielle : \begin{itemize}
    \item A cause de l'invariance par translation, on a pas d'information spacial.
    \item Signaux non dérivable : Avec que des portes (=des contours nettes dans images), pour l'approcher avec des $ \sin  $ il faut une infinité de $ \sin  $ 
\end{itemize}

\underline{Nouveau cours du 04/10} \\
\section{2chantillonage}
On doit échantilloné les signaux continues \begin{itemize}
    \item Le fenétrage : on limite le support (domaine du signal) dans le temps
    \item 
\end{itemize}

\subsection{Fenêtrage}
Classiquement on multiplie pas une fonction porte.

\subsubsection{1D}
La multiplication par une fonction rectangle $ \Leftrightarrow $ faire la convolution dans le domaine fréquentiel.

Mais visiblement ça complique pas mal la transformé en Fourier (voir image diapo 6 ). On retrouve des sinus cardianux. On verra en TD comment faire et si la taille de la fenêtre a une conséquence.

\subsubsection{2D}
Ici on multiplie par deux fonctions portes, ...
Mais on a la même chose en 3D au final, on retrouve le sinus cardinal 

Quand on prend une fenetre petite, la Fourier s'élargie fortement, ce qui peut la rendre illisible. Avec une fenetre large on tend vers une diract (diapo 12)

\subsection{Echantillonage}
On prend une mesure tous les x temps. Si fréquence trop faible, on n'arrive pas à reconstuire l'aspect continue, mais si trop grand on prend beaucoup de ressource de calcul.

\subsubsection{1D}
Pour faire ça on multiplie notre signal par un peigne de Dirac $ \mathrm{III} $, c'est une collection de Dirac. 

Qu'est ce qui se passe dans le domaine fréquentiel ? La TF d'un peigne de Dirac c'est une peigne de Dirac, c'est plutôt contre intuitif. Mais en gros ça rend la TF périodique. 

\paragraph*{Perte d'information}
Y'a-t-il une perte d'information pendant l'échantillonnage ? Oui et non \begin{itemize}
    \item Non Si on prend un signal borné séquentiellement. C'est à dire que la transformé de Fourier a un support borné sur l'axe des abscises
    \item Sinon oui il y a perte
\end{itemize}
Liste des signaux band-limité \begin{itemize}
    \item Rect non
    \item sinc oui
    \item sin oui 
    \item cos oui 
    \item Dirac oui 
    \item BIEN ÉCRIRE DIAPO
\end{itemize}

\paragraph*{Quel fréquence d'échantillonnage ?} Pour pouvoir échantillons sans perte un signal, il faut utilise une fréquence max deux fois plus grande que la fréquence max du signal. C'est le théorème de Shannon. DIAPO 23 J'suis pas sur de ce que j'ai écrit. 

\paragraph*{Reconstuire un signal échantillonné ?} On doit re-fenetrer. PAs compris vraiment mais en gros à la fin faux pas obtenir de courbe qui se chevauche. 

\paragraph*{CCL} : Si Shannon est vérifié, toute l'information est dans la TF, on peut reconstruire le signal avec la formule de reconstruction de Shannon

\paragraph*{Aliasing} Si on ne vérifie pas les dégradation on a un phénomène d'aliasing. Difficile à prédire. 
\begin{exmp}[Cas d'une fonction sin]
    DIAPO 30 TO 39
    Ici ça illustre les deux cas (correct et incorrect).\begin{itemize}
        \item Avec $ 4f_0 $, c'est suffisant pour reconstruire le signal.
        \item Diapo 33 : à droite on a plot la formule d'interpolation de Shannon. 
        \item On peut prendre une fréquence d'échantillonnage plus élevé mais ça change rien.
        \item DIAPO 35 : fréquence trop basse $\rightarrow$ mauvais fenêtrage 
        \item Diapo 37 : on peut voir une divergence des points rouge d'échantillonnage. 
    \end{itemize}
\end{exmp}

\subsubsection{2D}
Pareil, toujours les condition de Shannon : bande limité, fréquence d'échantillonnage. Plus restrictif car dans les deux direction. Le peigne de Dirac est représenté par une grille d'échantillonnage.

On peut utiliser une grille cartésienne ou hexagonale (qui a certain avantage). Diapo 45

Transformé de Fourier : il dit c'est pareil. On vas répéter le spectre dans toute les direction. Théorème de Shannon : pareil dans les deux directions. 

Reconstruction : toujours possible avec une plus grosse formule.

\paragraph*{Signaux à bande limité : Réalistique ? } En théorie non, jsp pk, mais en pratique on peut ignorer les fréquences de bruit créée. \begin{itemize}
    \item En pratique ça marche bien avec les signaux lisse et stationnaire comme un ECG.
    \item Pour les images naturels, chaque contours représente une forte fréquence (non lisse).
    \item Exemple d'aliasing diapo 58 59 60
\end{itemize}

\paragraph*{Anti-aliasing}
\begin{itemize}
    \item Filtrer toute les fréquences qu'on peut pas représenter avec un filtre passe bas à partir de la moitié de la fréquence d'échantillonnage. 
    \item Utile lorsque qu'on downsample une image. En retirant certain pixel, on perds certaine fréquence donc on crée de l'aliasing (?). Du coup on applique également un filtre aliasing.
\end{itemize}

\subsection{Quantification}
Après l'échantillonnage on applique la quantification. But : réduire le nombre de bits nécessaire pour encoder l'image (je crois). Deux type de quantifier \begin{itemize}
    \item Scalaire : chaque échantillon est quantifié
    \item Vecteur : une séquence d'échantillon est quantifié
\end{itemize}

\subsubsection{Scalar quantification}
Aucune idée de quoi on parle.

\section{Transformé de Fourier discrète}
C'est l'échantillonnage de la transformé de Fourier du signal échantillonné.  \begin{enumerate}
    \item Transformé de Fourier du signal échantillonné. Calcul DIAPO 70 me semble pas mal.
    \item On windows
    \item On resample la DFT pour obtenir N valeur (comme donné à l'origine.) : ça resemble beaucoup à la série de fourier mais avec un $ k $ discret plutôt qu'un $ x $ continue. 
\end{enumerate}
Si on a un signal de $ N $ sample, alors la FT nous rend $ N $ valeur tel que : la formule diapo 75. 

Il vas vite mais globalement pas de différence en 2D 

\section{What you need to know}
The difference between:
\begin{enumerate}
    \item Fourier transform of a continuous signal $\rightarrow$ a continuous function
    \item Fourier transform of a windowed signal $\rightarrow$ a continuous function
    \item Fourier Transform of a discrete (sampled) signal $\rightarrow$ again a continuous function
    \item discrete Fourier transform of a discrete signal $\rightarrow$ a discrete function
\end{enumerate}

\underline{Nouveau cours du 11/10} \\

\section{Linear filtering}
\subsection{Linear time-invariant system}
\begin{itemize}
    \item Linéaire + invariant dans le temps $\rightarrow$ Convolution.
    \item Filtrer en espace $ \Leftrightarrow $ filtrer en fréquence par la convolution. Voir les deux formules diapo 7
    \item Avantage et inconvénient des deux méthodes : dépendra de ce qu'on fait en pratique 
    \item La même chose en 1D discret, 2D Discret.
    \item On retient que c'est une convolution quoi mdr
\end{itemize}

\subsection{Spacial filtering}
Pourquoi filter : \begin{itemize}
    \item Virer le bruit, trouver les bords 
    \item Globalement on utilise une combinaison linéaire des pixel voisin pour déduire le nouveau pixel
    \item $ . \star h $ opérateur qui s'applique sur chaque pixel
\end{itemize}
\begin{defn}[le bruit]
    \begin{itemize}
        \item processus indésirable dont on connait idéalement la loi
        \item typiquement gaussien (type neige télé), ou impulse (arrive régulièrement dans les capteurs)
        \item Le flou est un bruit
    \end{itemize}
\end{defn}
\begin{exmp}[]
    Exemple de bruit diapo 19 : \begin{itemize}
        \item bruit gaussien
        \item poivre et sel pour la deuxième image 
        \item ?
        \item Bruit multiplicatif : grain
    \end{itemize}
\end{exmp}

Filtre spacial : 
\begin{itemize}
    \item On prend chaque pixel et on regarde les pixel autour 
    \item 2D : Formule plus simple à lire : pour le pixel $ i,j $ on regarde grâce aux sommes les pixel autour, pondéré par les valeurs de $ h $ 
    \item Deux cas pour $ h $ : finit (FIR) ou infini (IIR)
\end{itemize}
FIR Filter : 
\begin{itemize}
    \item Deux versions du filtre : une antisymétrique, quand on regarde en bas à droite on vas chercher la valeur en haut à droite. La version symétrique existe. C'est comme ça pour garder la commutativité de la convolution il parrain. 
    \item Algo pour le faire : DIAPO 24
\end{itemize}

On déplace une fenêtre sur chaque pixel. Comment faire pour les bords ? 
\begin{itemize}
    \item "Convolution linéaire" : En faite par la convolution si la fonction image vaut zéros alors la convolution vaut zéros. Fonctionne super bien quand la fonction est a support compacte. Mais sur une photo en réalité on a la scène qui est hors cadre qui est importante donc hypothèse bof validé. 
    \item "Convolution circulaire" : j'ai loupé merde
    \item On rogne l'image en ne traitant pas les bords.
\end{itemize}

Smoothing linear filters : 
\begin{itemize}
    \item Pour réduire le bruit on peut faire la moyenne des pixel autour. 
    \item Exemple de la matrice $ h $ diapo 29
    \item $\rightarrow$ on réduit les détail
    \item Comment ça se comporte en fréquence ? Filtre passe bas, idéal ? Voir TME
\end{itemize}

Gaussian Smoothing :
\begin{itemize}
    \item On pondère la moyenne par une gaussienne en choisissant bien $ \sigma  $. Il joue un rôle similaire à la taille du filtre moyenner. Plus il est grand plus on élimine de détail.
    \item Exemple numérique diapo 40
    \item Dans l'espace des fréquences, une gaussinne est une gaussienne. C'est un filtre passe bas non idéal. 
    \item Exemple de la fonction de transfert plotée dans les diapos suivante
\end{itemize}

Binomial filter:
\begin{itemize}
    \item Pour avoir la matrice on fait un produit cartésient du binome de newton
    \item Lowpass non ideal 
\end{itemize}
Autre filtre : 
\begin{itemize}
    \item Pyramidal : lowpass non ideal
    \item Conic : lowpass non ideal 
    \item Sharpening : high pass non ideal, increase image details
\end{itemize}

Gabor filter : 
\begin{itemize}
    \item On s'en est beaucoup servie pour la classification d'image
    \item Calcule des features pour différente orientation (?)
    \item Pour la formule il a pas trop su expliqué mais l'exp représente une partie de la gaussienne orienté dans une certaine direction $ \gamma  $. et la partie cos représente un détecteur de contours.
    \item Faire varier $ \theta  $ fait changer l'orientation 
    \item Faire varier $ s $, rend la dirac de plus en plus dirac
\end{itemize}

Filtre séparable :
\begin{itemize}
    \item La plupart des filtres 2D peuvent êtres exprimé par deux filtres 1D. (moyenne, gaussien, binomial, ...)
    \item Permet d'aller plus vite et même faire des algo récursif.
\end{itemize}

Filtrer les couleurs des images :
\begin{itemize}
    \item Comme $ h $ est une matrice, quand on multiplie le pixel vecteur de 3 couleurs \begin{itemize}
        \item Si la matrice est diagonale on traite les 3 channels pareil 
        \item Sinon non 
    \end{itemize}
    \item Pratique car les canaux RGB sont relativement indépendant 
    \item Mais attention on peut créer des fausse couleurs parfois comme l'indépendance n'est pas pur.
\end{itemize}

\section{Filtering in the frequency domain}
\begin{defn}[] 
    On considère un signal discret dont on vas modifier certaine composante de fréquence
    \begin{itemize}
        \item Dans le domaine spacial = convolution
        \item La on vas multiplier les valeur dans le domaine des fréquences
    \end{itemize}
    \item 3 familles : lowpass, highpass, bandpass
    \item ideal : les coef sont égal à 1 ou zéro, ça passe ou ça passe pas
\end{defn}
Principe : DIAPO 60 
\begin{enumerate}
    \item On prend la DFT
    \item On créer notre $ H $ et on la complete avec des zéros pour faire un multiplication de matrice ez (voir diapo 61)
    \item On multiplie element wise
    \item Inverse DFT $\rightarrow$ filtrered image
\end{enumerate}
Exemple diapo 62 : on cut le bruit net

Lowpass 2D filter:
\begin{itemize}
    \item 
\end{itemize}

ideal lowpass 2D filter:
\begin{itemize}
    \item IMAGE diapo 66
    \item La ligne de la DFT de base : Pourquoi ? parce que l'image originale peut être vu comme une fonction porte de FFT $ sinc $. Puis après le filtre la FFT est proche d'une fonction porte du coup on retrouve une sorte de $ sinc $ dans l'image filtré == Gibbs artefacts 
    \item Conséquence : ... Diapo 67
    \item Dans l'espace normal, c'est une convolution avec une fonction de Bessel
\end{itemize}
Les filtres idéaux cool quand on connait la fréquence précise à cut, mais on a des gibbs artefact.

Lowpass butterworth 2D filter :
\begin{itemize}
    \item Le paramètre $ n $ permet de faire varier la resemblance avec une porte. Comme elle est continue est dérivable ça permet de limiter l'effet Gibbs. 
\end{itemize}

Le filtre anti aliasing : 
\begin{itemize}
    \item Pour limiter les effet d'antialiasing, on vas filter les fréquences qu'on capture autour appartenant au autre sinc.
\end{itemize}

Highpass 1D filtering : 
\begin{itemize}
    \item Même chose que tout à l'heure mais on inverse 
\end{itemize}

Passe bande :
\begin{itemize}
    \item "C'est le tric intermédiaire"
    \item on coupe à droite et à gauche
    \item Ca se présente comme un anneaux en 2D
    \item Dans l'exemple diapo 85, on isole une fréquence, on récupère deux diract, qui donne presque un cosinus.
\end{itemize}

\section{Filtrage non linéaire}
Le filtre mediant :
\begin{itemize}
    \item Fait la médiane du voisinage
    \item Parfait pour les bruit "salt and pepper"car le bruit est ponctuel.
    \item Préserve les contours : on en discutera plus tard
    \item Réduit aussi les autres bruits
\end{itemize}

Autre filtre non linéaire :
\begin{itemize}
    \item Filtre max : Supprime le bruit poivre
    \item Filtre min : Supprime le bruit sel
    \item On peut les composer et les stack
    \item Nagao filter : On peut prendre des fenêtre bizarre au sein de la grande fenêtre. Puis il prend la moyenne de plein de sous fenêtre bizarre et change la valeur du pixel sur la plus petite. 
\end{itemize}

\underline{Nouveau cours6 du 18/10} \\

BEFORE DIAPO 12  BIG RETARD 

Edge Model
\begin{itemize}
    \item On défini 
\end{itemize}

\section{Edge detection with filtering}
\subsection{First order approaches}
Principe 
\begin{itemize}
    \item On peut pas faire tendre $ h \to 0 $ car on est sur une grille de pixel indéxé sur $ \mathbb{N} $, donc on vas supprimer la limite. On dit qu'on fait une différence fini. 
    \item Il a dit c'est équivalent à une convolution. 
\end{itemize}
Discrete approximation of gradient
\begin{enumerate}
    \item VOIR DIAPO ETAPE de l'algo 
    \item 6) Edge linking : on prolonge le frontière dans l'espoir d'avoir un truc qui se ferme et d'avoir un contour. 
\end{enumerate}
\begin{itemize}
    \item Pas de choix meilleurs que d'autre
    \item Roberts : calcule les gradients direction $ \pi /4 $ 
    \item Où on met l'origine du masque ? Il a dit "je vous laisse refléchir" gdshgis
    \item Diapo 23 : le premier c'est comme la matrice. Filtre passe haut dans la direction abscice
    \item Diapo 24 : c'est le Robert, pareil la première image c'est comme la matrice. Finalement ça resemble au filtre gradient mais pivoté, d'où la matrice. Passe bande dans une direction
    \item Diapo 25 : Filtre de Prewitt avec les colonne de 1, deux pentes, deux sinus cardianux. Plutôt passe bande.
    \item Diapo 26 : Sobel filter. Proche du précédent. Fait disparaitre les lobes des sinc
    \item Diapo 27 : On moyenne avec le vecteur vertical, et on dérive avec le vecteur horizontale. Pourquoi on moyenne ? Pour prendre en compte les contours.
    \item Diapo 28/29 : Filtre + réponse impultionnel. Filtre moyenneur => Resemble à un sinc dans Fourier. Filtre qui resemble à une gaussienne => Une gaussienne dans Fourier
    \item Diapo 31 : Ce filtre permet de capturer les contours dans plusieurs direction en faisant pivoter les chiffres de la matrice. 
    \item Diapo 32 : belle exemple de comment faire sur une omage. Image $ \theta  $ c'est les directions, mais comme on fait une division dans le $ \arctan  $ c'est pas très résistant au bruit
    \item Diapo 34 : Ici on fait varier le seuil pour la carte de la norme $ \left\| G \right\|  $  Trop bas, on s'assure les vrais positifs mais peu de point.A l'inverse trop de point avec beaucoup de faux positif. 
    \item Diapo 35 : On peut lisser les contours avant la detection de contour avec un filtre gaussien ou le médiant. Celà a pour effet d'épaissir les trait de contour.
    \item Diapo 36 : Exemple avece un filtre gaussien
    \item Diapo 37 : High smoothing : robuste au bruit mais bord épais (localisation imprécise). Faible = inverse. Threshold : 
\end{itemize}

Digression : Texture in Image 
\begin{itemize}
    \item Définition : spatial repetition of the same pattern whatever the direction
    \item Processus stochastic et stationnaire. 
    \item Diapo 40 : Texture : pas vraiment d'orientation de direction, contrairement à nos contour. Le plus simple est de lisser l'image (perte de loc) ou seuillage (autre problème)
\end{itemize}

\subsection{Second order approache}
\begin{itemize}
    \item Le laplacien est invariant par rotation 
    \item Diapo 43 : de tout manière on vas approcher le laplacien. Marche mal sur les coins. 
    \item Diapo 44 : méthode différence fini pour approcher le laplacien. Y'a un lien entre les matrices en bas et la formule, c'est les coef de la somme. la deuxième matric est plus robuste aux rotations.
    \item Diapo 45 : passe haut 
    \item Diapo 46 : passe haut 
    \item Diapo 47 : Tuto appliquer la detection de bord avec le laplacien : On prend l'image, on convulutionne avec les laplaciens précédent. Et on regarde les passages par zéro : aka les changements de signes. Pour ça on regarde les min et max + un seuil pour éviter le bruit
    \item Diapo 48 réponse du laplacien sans seuil 
    \item Diapo 49 : 
    \item Diapo 50 : Pro and cons du laplacien vs le gradient : lire le diapo
    \item Diapo 51 : Pré-processing : les math du pourquoi ça marche un filtre \begin{enumerate}
        \item .
        \item dans l'équation (6) on utlise la dernière égalité 
        \item Car on connait bien g
    \end{enumerate}
    \item Diapo 52 : 
    \item Diapo 53 : C'est proche de ce qui se passe dans le cortex visuel. On aime bien les lissages à différente valeur de $ \sigma  $, il parrait que ça permet de voir les objects d'une certaine taille == pyramide de résolution
    \item Diapo 54 : Pyramide de résolution : filtre gaussien $\rightarrow$ subsampling $\rightarrow$boucle. En faite ça permet de capturer les bords de toutes les tailles.
    \item Diapo 55 : Après on combiner tous les résultats : multiscale fusion
    \item Diapo 57-60 : Exemple 
\end{itemize}
\section{Approche continue}
\subsection{Optimal filtering}
Approche continue :
\begin{itemize}
    \item Canny a maximiser des critère qu'il trouvait important, en supposant un bruit gaussien
    \item 3 critères : Bonne detection, bonne localization, unicité $ \Leftrightarrow $ un un filtre dériveur qui vérifie des hypothèses mathématiques correspondant aux 3 criètre.
    \item Finalement c'est proche d'une gaussienne. Diapo 65
    \item Y'a plusieurs solution mathématique.
    \item Diapo 67 : on peut simplifier la solution en passant sur un support infini (IIR) + implémentation récursive == Canny Deriche == rapide, paramètre $ \alpha  $ 
    \item Canny Deriche : $ \alpha  $ même effet que pour la gaussienne : épaisseur, précision bruit. 
\end{itemize}

\section{Post processing}
\subsection{Non maxima suppression, threshold and edge linking}
Post processing
\begin{itemize}
    \item Diapo 72-73-74
    \item Diapo 75 : Finalement on a que 8 direction comme on est sur une grille de point. On peut booster en gardant que les points estimé dans ces directions (pas sûre si j'ai bien compris)
\end{itemize}
Thresholding : diapo 77
\begin{itemize}
    \item Technique basique 
    \item Technique hysteresis : super puissant. Premier seuillage, puis deuxième seuillage en gardant les pixel qui ont un voisinage élevé (on vire les points seules finalement). Honnêtement pas tout compris.
    \item Finalement c'est une manière de prolonger les contours ! 
\end{itemize}
Edge linking and boundary detection : prologement de contour
\begin{itemize}
    \item Et avoir des contours continue c'est important pour faire de la detection de zone.
    \item On peut trasformer les pixel en un graph et chercher les cycles de ce graph en posant certaine condition. 
    \item On peut essayer de retrouver une forme simple avec le bord (cercle, rectangle, ect) en utilisant une méthode de régression ou avec une transformé de Hough (on process par vote, mais coûteux)
\end{itemize}
\end{document}